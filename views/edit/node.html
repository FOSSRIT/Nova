{{extend 'csi_view.html'}}

<div id="editform">
    {{if node:}}
        <a href="{{=URL('main','node', args=node.url)}}" >Back to Page</a>.
    {{pass}}
    <fieldset>
        <legend>Edit Page</legend>
         Note: Description and Attributes can use <a href="{{=URL('examples','static','markmin.html')}}">markmin syntax</a>.
        {{=form}}
        <script type="text/javascript">
        $(document).ready(function() {
 // hides the slickbox as soon as the DOM is ready
 // (a little sooner than page load)
  $('#slickbox').hide();
 
 // toggles the slickbox on clicking the noted link  
  $('a#slick-toggle').click(function() {
    $('#slickbox').toggle('slow');
    return false;
  });
});
</script>
<div id="webcam_holder">
        <br><br>Got a webcam? <a href="#" id="slick-toggle">Click here to take take a snapshot!</a><br>
        
        <div id="upload_results" style="background-color:#eee;"></div>
        <div id="slickbox">
        
            {{include "htmlblocks/take_picture.html"}}
    
            <script language="JavaScript">
                webcam.set_hook( 'onComplete', 'my_completion_handler' );
            
                function do_upload() {
                    // upload to server
                    document.getElementById('upload_results').innerHTML = '<b>Uploading...</b>';
                    webcam.upload();
                }
        
                function my_completion_handler(msg) {
                    document.getElementById('upload_results').innerHTML = "<b>Upload Complete</b>";
                    $('#slickbox').toggle(4000);
                }
                
                
                $("#webcam_holder").insertAfter("#node_picFile");
            </script>
      
        </div>
        </div>
    </fieldset>

    {{if attribute_form:}}
    <fieldset>
        <legend>Add Section</legend>
        {{=attribute_form}}
        <a href="{{=URL('attribute_vocab', args=node.url)}}">Add New Section Title</a>.
    </fieldset>
    {{pass}}
    
  {{if attr:}}
 <fieldset>
 <legend>Current Sections</legend>

 <form method="post" action="{{=URL(args=node.url)}}">
 <br />Leave blank to remove<br /><br />
 
               <ul>
                 {{for x in attr:}}
                 <li><label for="attr.{{=x.id}}">{{=x.vocab.value}}:</label>
                     <input type="text" name="attr.{{=x.id}}" value="{{=x.value}}" />
                 </li>
                 {{pass}}
              </ul>
              <input type="submit"/>
 </form>
 </fieldset>
 {{pass}}
 </div>
