{{extend 'csi_view.html'}}

<h2>This Form is being Phased out</h2>
Please try using the in place editing first.

<div id="editform">
    {{if node:}}
        <a href="{{=URL('main','node', args=node.url)}}" >Back to Page</a>.
    {{pass}}
    <fieldset>
        <legend>Edit Page</legend>
         Note: Description and Attributes can use <a href="{{=URL('examples','static','markmin.html')}}">markmin syntax</a>.
        {{=form}}
        <script type="text/javascript">
        $(document).ready(function() {
 // hides the slickbox as soon as the DOM is ready
 // (a little sooner than page load)
  $('#slickbox').hide();
 
 // toggles the slickbox on clicking the noted link  
  $('a#slick-toggle').click(function() {
    $('#slickbox').toggle('slow');
    return false;
  });
});
</script>
        <br>Got a webcam? <a href="#" id="slick-toggle">Click here to take take a snapshot</a><br>
        
        <div id="upload_results" style="background-color:#eee;"></div>
        <div id="slickbox">
        {{if node:}}
            <!-- First, include the JPEGCam JavaScript Library -->
            <script type="text/javascript" src="{{=URL('static','jpegcam/webcam.js')}}"></script>
    
            <!-- Configure a few settings -->
            <script language="JavaScript">
                webcam.set_api_url( '{{=URL('take_picture',args=node.url, vars={"do_upload":True})}}' );
                webcam.set_swf_url( '{{=URL('static','jpegcam/webcam.swf')}}')
                webcam.set_shutter_sound( true, '{{=URL('static','jpegcam/shutter.mp3')}}')
                webcam.set_quality( 75 ); // JPEG quality (1 - 100)
            </script>
    
            <!-- Next, write the movie to the page at 320x240 -->
            <script language="JavaScript">
                document.write( webcam.get_html(320, 240) );
            </script>
    
            <!-- Some buttons for controlling things -->
            <br/>
            <form>
                <input type=button value="Configure..." onClick="webcam.configure()">
                &nbsp;&nbsp;
                <input type=button value="Capture" onClick="webcam.freeze()">
                &nbsp;&nbsp;
                <input type=button value="Upload" onClick="do_upload()">
                &nbsp;&nbsp;
                <input type=button value="Reset" onClick="webcam.reset()">
            </form>
    
            <script language="JavaScript">
                webcam.set_hook( 'onComplete', 'my_completion_handler' );
            
                function do_upload() {
                    // upload to server
                    document.getElementById('upload_results').innerHTML = '<b>Uploading...</b>';
                    webcam.upload();
                }
        
                function my_completion_handler(msg) {
                    document.getElementById('upload_results').innerHTML = "<b>Upload Complete</b>";
                    $('#slickbox').toggle(4000);
                }
            </script>
            {{else:}}
            Please create the page first before trying to upload a picture.
            {{pass}}
        </div>
    </fieldset>

    {{if attribute_form:}}
    <fieldset>
        <legend>Add Section</legend>
        {{=attribute_form}}
        <a href="{{=URL('attribute_vocab', args=node.url)}}">Add New Section Title</a>.
    </fieldset>
    {{pass}}
    
  {{if attr:}}
 <fieldset>
 <legend>Current Sections</legend>

 <form method="post" action="{{=URL(args=node.url)}}">
 <br />Leave blank to remove<br /><br />
 
               <ul>
                 {{for x in attr:}}
                 <li><label for="attr.{{=x.id}}">{{=x.vocab.value}}:</label>
                     <input type="text" name="attr.{{=x.id}}" value="{{=x.value}}" />
                 </li>
                 {{pass}}
              </ul>
              <input type="submit"/>
 </form>
 </fieldset>
 {{pass}}
 </div>
